---
title: "Chrysoblephus diet data analysis"
author: "Joshua Dwyer-Thiem"
date: "2026-02-24"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##  Diet data analysis:

### Data wrangling and brief analysis of Chrysoblephus gibbiceps diet data

This document contains the code used in **Chrysoblephus_diet_raw_script** but was made to present the reasoning behind the code used and results in a more palatable and descriptive format. Please refer to **Chrysoblephus_diet_raw_script** if you wish to view the code by itself.  <br><br><br>

First I loaded the required packages.These were installed via the **install.R** file.  


```{r loading packages, echo=TRUE}
library(tidyverse) 
library(dplyr)
library(ggplot2)
library(here)

```

The second step was to read in the data (CSV format) then view it to check for obvious errors and that it was in tidy format. 

```{r reading in data and viewing, echo=TRUE}
#Reading in data as a CSV
data_raw<-read_csv(here("Data","ChrysoblephusDiet.csv"))

#looking at raw data 
head(data_raw )

```

After viewing the raw data, it is clear that it is in tidy format already; each variable forms a column, each observation forms a row and each cell is a single measurement. To view the raw data itself and an explanation of its contents please refer to my **Data** folder. 


Although my data were tidy, I spotted a missing value and so decided to scan for more.

```{r missing values}
#scanning for missing values
data_raw %>%
  summarise_all(~sum(is.na(.))) %>% 
  print()

```

The above code revealed multiple missing values across a range of columns, which could complicate  analysis. Therefore the next step was to remove them:

```{r removing missing values}
#removing missing values
cleaned_data <- data_raw %>% 
  drop_na() %>%
  print()

```

The missing values were removed successfully and the raw data was transferred to "cleaned_data". The cleaned data-frame with no missing values is accessible in my **Data** folder (as "cleaned_ChrysoblephusDiet"). To check if the above code was successful I used the following code:

```{r checking if all the missing values were removed}
#Checking if the above worked 
cleaned_data %>%
  summarise_all(~sum(is.na(.))) %>% 
  print()

```

Once the missing values were removed, the data were ready for analysis. However I was only interested in the relationships between fish body mass and empty stomach mass and fish body mass and stomach content mass (all measured in Grams). Therefore I created a new tibble of a subset of those three variables (stomach_data).

```{r subsetting data set to 3 variables of interest,echo=TRUE }
stomach_data <- cleaned_data %>%
  select(
    `weighed_fish`, `Empty stomach mass (g)`, `Stomach contents (g)`)

#viewing new tibble
stomach_data

```


Once I had my new tibble of body mass, empty stomach mass and stomach content mass, I planned to create two linear model scatter plots. But first I wanted to calculate the R² value of the relationship between fish body mass and empty stomach mass and fish body mass and stomach content mass, in order to display this on the two plots. 

```{r calculating R^2 }
#calculating R^2 in order to display it on my plots 
# Using cor() squared (Pearson correlation squared)

#R^2 for body mass vs stomach mass
R_squared_plot1 <- cor(stomach_data$weighed_fish,stomach_data$`Empty stomach mass (g)`)^2


#R^2 for body mass vs stomach content mass
R_squared_plot2 <- cor(stomach_data$weighed_fish,stomach_data$`Stomach contents (g)`)^2

```


After I had the R^2 values it was time to construct the two plots using ggplot. The first plot is body mass vs empty stomach mass. The plot shows that as body mass increases, so does empty stomach mass.

```{r plot of body mass vs empty stomach mass}
#plot 1:
#plotting body weight vs empty stomach mass

ggplot(stomach_data, aes(x = `weighed_fish`, y = `Empty stomach mass (g)`)) +
  geom_point(alpha = 0.6, color = "#1f78b4") +
  geom_smooth(method = "lm", se = FALSE, color = "#33a02c") +
  
  annotate(
    "text",
    x = 1000, y = 25,  
    label = paste0("R² = ", round(R_squared_plot1, 3)),
    size = 5,
    color = "black") +
 
  labs(x = "Body mass (g)", y = "Empty stomach mass(g)",
       title = "Relationship of body mass with stomach mass") +
  theme_minimal(base_size = 12)
```

The second plot is Body mass vs stomach content mass. This plot shows that as body mass increases stomach content mass seems to roughly increase too. This would make sense as bigger fish would be able to eat bigger and more prey. 


```{r plot of body mass vs stomach content mass}

#plot 2: 
#plotting body mass vs stomach content mass

ggplot(stomach_data, aes(x = `weighed_fish`, y = `Stomach contents (g)`)) +
  geom_point(alpha = 0.6, color = "#1f78b4") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  
  annotate(
    "text",
    x = 1000, y = 25,  
    label = paste0("R² = ", round(R_squared_plot1, 3)),
    size = 5,
    color = "black") +
  
  
  labs(x = "Body mass (g)", y = "Mass of stomach contents(g)",
       title = "Relationship of body mass with mass of stomach content") +
  theme_minimal(base_size = 12)
```




